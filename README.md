# IR Note - 決算資料検索サービス

証券コードを入力すると、その企業の過去5年分の決算説明会資料を一覧表示するWebアプリケーションです。

## 機能

- 4桁の証券コード入力による検索
- 過去5年分の決算資料を年度別に表示
- 決算説明会資料と決算短信の両方に対応
- レスポンシブデザイン（モバイル対応）

## 技術スタック

### フロントエンド
- React 18
- TypeScript
- Vite
- CSS3

### バックエンド
- Python 3.x
- Flask
- Flask-CORS

## セットアップ

### 必要な環境
- Node.js 18以上
- Python 3.8以上

### クイックスタート（推奨）

```bash
# プロジェクトルートで実行
./start.sh
```

このスクリプトがバックエンドとフロントエンドを自動的に起動します。

### バックエンドのセットアップ

```bash
cd backend

# 仮想環境の作成（推奨）
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 依存パッケージのインストール
pip install -r requirements.txt

# サーバーの起動
python app.py
```

バックエンドは `http://localhost:5000` で起動します。

### フロントエンドのセットアップ

```bash
cd frontend

# 依存パッケージのインストール
npm install

# 開発サーバーの起動
npm run dev
```

フロントエンドは `http://localhost:5173` で起動します。

## 使い方

1. フロントエンドとバックエンドの両方を起動
2. ブラウザで `http://localhost:5173` を開く
3. 4桁の証券コードを入力（例: 7203 = トヨタ自動車）
4. 検索ボタンをクリック
5. 過去5年分の決算資料が年度別に表示されます

## API エンドポイント

### GET /api/health
ヘルスチェック用エンドポイント

**レスポンス:**
```json
{
  "status": "ok"
}
```

### GET /api/earnings/:stock_code
指定された証券コードの決算資料を取得

**パラメータ:**
- `stock_code`: 4桁の証券コード（例: 7203）

**成功レスポンス:**
```json
{
  "stock_code": "7203",
  "materials": [
    {
      "title": "2024年3月期 第4四半期決算説明会資料",
      "company_name": "トヨタ自動車株式会社",
      "stock_code": "7203",
      "fiscal_year": "2024年3月期",
      "period": "通期",
      "announcement_date": "2024-05-15",
      "pdf_url": "https://example.com/ir/7203/2024_Q4_presentation.pdf",
      "type": "決算説明会資料"
    }
  ]
}
```

**エラーレスポンス:**
```json
{
  "error": "無効な証券コードです。4桁の数字を入力してください。"
}
```

## プロジェクト構成

```
ir-note/
├── backend/
│   ├── app.py                 # Flaskアプリケーション
│   ├── earnings_scraper.py    # 決算資料取得ロジック
│   └── requirements.txt       # Python依存パッケージ
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── SearchForm.tsx        # 検索フォーム
│   │   │   ├── SearchForm.css
│   │   │   ├── MaterialsList.tsx     # 資料一覧表示
│   │   │   └── MaterialsList.css
│   │   ├── types.ts                  # TypeScript型定義
│   │   ├── App.tsx                   # メインアプリ
│   │   ├── App.css
│   │   ├── index.css
│   │   └── main.tsx
│   ├── package.json
│   └── vite.config.ts
└── README.md
```

## 現在の実装状況

### ✅ 実装済み機能
- 証券コード入力による検索機能
- 過去5年分の決算資料の生成と表示
- 年度別・四半期別の決算資料一覧
- 決算説明会資料、決算短信、有価証券報告書の区別
- 実際の企業IRページのURLパターンに基づいたリンク生成
- レスポンシブデザイン

### 🚧 開発中の機能

現在、以下のソースからの実際のスクレイピング機能を実装中です：

1. **TDnet（適時開示情報閲覧サービス）**
   - 東京証券取引所の公式開示サービス
   - 日次の開示情報をスクレイピング
   - 実装済みだが、現在はデバッグモードでスキップ中

2. **IR BANK**
   - 多くの企業のIR資料が集約されているサイト
   - 決算説明会資料や決算短信を取得
   - 実装済みだが、現在はデバッグモードでスキップ中

3. **BuffettCode**
   - 企業のIR情報を提供するサービス
   - 実装済みだが、現在はデバッグモードでスキップ中

### 📊 デモデータについて

現在のバージョンでは、実際のスクレイピングの代わりに、**リアルなURLパターンを使用したサンプルデータ**を表示しています。

- トヨタ自動車、ソフトバンクG、ソニーGなど主要企業のIRページURLを参考
- 実際の決算発表スケジュールに基づいた日付設定
- 過去5年分の四半期決算・通期決算データ

### 🔜 今後の拡張予定

- [ ] 実際のWebスクレイピング機能の有効化
- [ ] EDINET API連携
- [ ] PDF資料のプレビュー機能
- [ ] 検索履歴の保存
- [ ] お気に入り企業の登録
- [ ] 決算資料の比較機能
- [ ] データベースへのキャッシング
- [ ] より多くの企業のサポート

## 注意事項

- 現在表示されているURLは実際の企業IRページのパターンに基づいていますが、すべてが有効なリンクとは限りません
- 実際のスクレイピングを有効にする場合は、各サービスの利用規約を確認し、適切なレート制限を設けてください
- Webスクレイピングは各サイトの構造変更により動作しなくなる可能性があります

## ライセンス

MIT License

## 作者

© 2025 IR Note
